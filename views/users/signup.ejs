<%- include('../partials/header') %>
<%- include('../partials/headercopy') %>

<main class="main">
  <div class="page-header breadcrumb-wrap">
    <div class="container">
      <div class="breadcrumb">
        <a href="/" rel="nofollow">Home</a>
       <span></span> Login / SignUp
      </div>
    </div>
  </div>
  <div class="text-center">
    <div class="col-lg-6 offset-lg-3">
      <div
        class="login_wrap widget-taber-content p-30 background-white border-radius-5"
      >
        <div class="padding_eight_all bg-white">
          <div class="heading_s1">
            <h3 class="mb-30">SIGN UP</h3>
          </div>

          <div>
            <% if(message){ %>
              <h4 style="color: red;"><%= message %></h4>
            <% } %> 
          </div>
          
          <p class="mb-50 font-sm"></p>
          <form method="post" action="/signup" id="form">
            <div class="form-group">
                <input type="text" required name="username" id="username" placeholder="Username" />
                <span class="error"></span>
            </div>
            <div class="form-group">
                <input type="text" required name="email" id="email" placeholder="Email" />
                <span class="error"></span>
            </div>
            <div class="form-group">
                <input required type="password" name="password" id="password" placeholder="Password" />
                <span class="error"></span>
            </div>
            <div class="form-group">
                <input required type="password" name="password2" id="password2" placeholder="Confirm password" />
                <span class="error"></span>
            </div>
            <div class="form-group">
              <input type="text" id="referralCode" name="referralCode" class="form-control" placeholder="Referral Code" />
              <div id="referralCodeError" class="error-message"></div>
          </div>
            <div class="login_footer form-group">
                <div class="chek-form">
                    <div class="custome-checkbox"></div>
                </div>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-fill-out btn-block hover-up" name="">Submit & Register</button>
            </div>
        </form>
          <div class="divider-text-center mt-15 mb-15">
            <span> or</span>
          </div>
          <ul class="btn-login list_none text-center mb-15">
            <li>
              <!-- <a href="#" class="btn btn-facebook hover-up mb-lg-0 mb-sm-4"
                >Login With Facebook</a
              > -->
            </li>
            <li>
              <a href="#" class="btn btn-google hover-up">Login With Google</a>
            </li>
          </ul>
          <div class="text-muted text-center">
            Already have an account? <a href="/login">Sign in now</a>
          </div>
          </div>    
          </div>
          <div</div>
          </main>

          <script>
            const form = document.getElementById('form');
            const username = document.getElementById('username');
            const email = document.getElementById('email');
            const password = document.getElementById('password');
            const password2 = document.getElementById('password2');
            
            form.addEventListener('submit', e => {
              const isValid = validateInputs();
              if (!isValid) {
                e.preventDefault();
              }
            });
            
            const setError = (element, message) => {
              const inputControl = element.parentElement;
              const errorDisplay = inputControl.querySelector('.error');
              errorDisplay.innerText = message;
              inputControl.classList.add('error');
              inputControl.classList.remove('success');
            };
            
            const setSuccess = element => {
              const inputControl = element.parentElement;
              const errorDisplay = inputControl.querySelector('.error');
              errorDisplay.innerText = '';
              inputControl.classList.add('success');
              inputControl.classList.remove('error');
            };
            
            const isValidEmail = email => {
              const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
              return re.test(String(email).toLowerCase());
            };
            
            const isValidPassword = password => {
              const re = /^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*]).{8,}$/;
              return re.test(password);
            };
            
            const validateInputs = () => {
              const usernameValue = username.value.trim();
              const emailValue = email.value.trim();
              const passwordValue = password.value.trim();
              const password2Value = password2.value.trim();
            
              let isValid = true;
            
              if (usernameValue === '') {
                setError(username, 'Username is required');
                isValid = false;
              } else {
                setSuccess(username);
              }
            
              if (emailValue === '') {
                setError(email, 'Email is required');
                isValid = false;
              } else if (!isValidEmail(emailValue)) {
                setError(email, 'Provide a valid email address');
                isValid = false;
              } else {
                setSuccess(email);
              }
            
              if (passwordValue === '') {
                setError(password, 'Password is required');
                isValid = false;
              } else if (!isValidPassword(passwordValue)) {
                setError(password, 'Password must be at least 8 characters, include an uppercase letter, a number, and a special character');
                isValid = false;
              } else {
                setSuccess(password);
              }
            
              if (password2Value === '') {
                setError(password2, 'Please confirm your password');
                isValid = false;
              } else if (password2Value !== passwordValue) {
                setError(password2, 'Passwords do not match');
                isValid = false;
              } else {
                setSuccess(password2);
              }
            
              return isValid; 
            };
            </script>
          
          
<%- include('../partials/footercopy') %> 
<%- include('../partials/footer') %>